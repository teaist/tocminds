/**
 * @fileoverview added by tsickle
 * Generated from: cmds/extract/translation_files/xliff2_translation_serializer.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { XmlFile } from './xml_file';
var Xliff2TranslationSerializer = /** @class */ (function () {
    function Xliff2TranslationSerializer() {
    }
    /**
     * @param {?} messages
     * @param {?} locale
     * @param {?=} isTarget
     * @return {?}
     */
    Xliff2TranslationSerializer.prototype.renderFile = /**
     * @param {?} messages
     * @param {?} locale
     * @param {?=} isTarget
     * @return {?}
     */
    function (messages, locale, isTarget) {
        var _this = this;
        if (isTarget === void 0) { isTarget = false; }
        /** @type {?} */
        var xml = new XmlFile();
        xml.startTag('xliff', {
            version: '2.0',
            xmlns: 'urn:oasis:names:tc:xliff:document:2.0',
            srcLang: locale,
            trgLang: locale
        });
        xml.startTag('file');
        messages.forEach((/**
         * @param {?} message
         * @return {?}
         */
        function (message) {
            xml.startTag('unit', {
                id: ((/** @type {?} */ (message))).id ||
                    ((/** @type {?} */ (message))).messageId
            });
            if (message.meaning || message.description) {
                xml.startTag('notes');
                if (message.description) {
                    _this.renderNote(xml, 'description', message.description);
                }
                if (message.meaning) {
                    _this.renderNote(xml, 'meaning', message.meaning);
                }
                xml.endTag('notes');
            }
            xml.startTag('segment');
            if (!isTarget) {
                _this.generateMessageTag(xml, 'source', message);
            }
            _this.generateMessageTag(xml, 'target', message);
            xml.endTag('segment');
            xml.endTag('unit');
        }));
        xml.endTag('file');
        xml.endTag('xliff');
        return xml.toString();
    };
    /**
     * @private
     * @param {?} xml
     * @param {?} tagName
     * @param {?} message
     * @return {?}
     */
    Xliff2TranslationSerializer.prototype.generateMessageTag = /**
     * @private
     * @param {?} xml
     * @param {?} tagName
     * @param {?} message
     * @return {?}
     */
    function (xml, tagName, message) {
        xml.startTag(tagName, {}, { preserveWhitespace: true });
        this.renderMessage(xml, message);
        xml.endTag(tagName, { preserveWhitespace: false });
    };
    /**
     * @private
     * @param {?} xml
     * @param {?} message
     * @return {?}
     */
    Xliff2TranslationSerializer.prototype.renderMessage = /**
     * @private
     * @param {?} xml
     * @param {?} message
     * @return {?}
     */
    function (xml, message) {
        xml.text(message.messageParts[0]);
        for (var i = 1; i < message.messageParts.length; i++) {
            /** @type {?} */
            var placeholderName = message.placeholderNames[i - 1];
            if (placeholderName.startsWith('START_')) {
                xml.startTag('pc', {
                    id: "" + i,
                    equivStart: placeholderName,
                    equivEnd: placeholderName.replace(/^START/, 'CLOSE')
                });
            }
            else if (placeholderName.startsWith('CLOSE_')) {
                xml.endTag('pc');
            }
            else {
                xml.startTag('ph', { id: "" + i, equiv: placeholderName }, { selfClosing: true });
            }
            xml.text(message.messageParts[i]);
        }
    };
    /**
     * @private
     * @param {?} xml
     * @param {?} name
     * @param {?} value
     * @return {?}
     */
    Xliff2TranslationSerializer.prototype.renderNote = /**
     * @private
     * @param {?} xml
     * @param {?} name
     * @param {?} value
     * @return {?}
     */
    function (xml, name, value) {
        xml.startTag('note', { category: name }, { preserveWhitespace: true });
        xml.text(value);
        xml.endTag('note', { preserveWhitespace: false });
    };
    return Xliff2TranslationSerializer;
}());
export { Xliff2TranslationSerializer };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieGxpZmYyX3RyYW5zbGF0aW9uX3NlcmlhbGl6ZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AbG9jbC9jbGkvIiwic291cmNlcyI6WyJjbWRzL2V4dHJhY3QvdHJhbnNsYXRpb25fZmlsZXMveGxpZmYyX3RyYW5zbGF0aW9uX3NlcmlhbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFVQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBRXJDO0lBQUE7SUFvRkEsQ0FBQzs7Ozs7OztJQW5GQyxnREFBVTs7Ozs7O0lBQVYsVUFDRSxRQUFrRCxFQUNsRCxNQUFjLEVBQ2QsUUFBZ0I7UUFIbEIsaUJBd0NDO1FBckNDLHlCQUFBLEVBQUEsZ0JBQWdCOztZQUVWLEdBQUcsR0FBRyxJQUFJLE9BQU8sRUFBRTtRQUN6QixHQUFHLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRTtZQUNwQixPQUFPLEVBQUUsS0FBSztZQUNkLEtBQUssRUFBRSx1Q0FBdUM7WUFDOUMsT0FBTyxFQUFFLE1BQU07WUFDZixPQUFPLEVBQUUsTUFBTTtTQUNoQixDQUFDLENBQUM7UUFDSCxHQUFHLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JCLFFBQVEsQ0FBQyxPQUFPOzs7O1FBQUMsVUFBQSxPQUFPO1lBQ3RCLEdBQUcsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFO2dCQUNuQixFQUFFLEVBQ0EsQ0FBQyxtQkFBQSxPQUFPLEVBQWtCLENBQUMsQ0FBQyxFQUFFO29CQUM5QixDQUFDLG1CQUFBLE9BQU8sRUFBdUIsQ0FBQyxDQUFDLFNBQVM7YUFDN0MsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxPQUFPLENBQUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxXQUFXLEVBQUU7Z0JBQzFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3RCLElBQUksT0FBTyxDQUFDLFdBQVcsRUFBRTtvQkFDdkIsS0FBSSxDQUFDLFVBQVUsQ0FBQyxH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QUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxrQkFBa0IsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZFLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsRUFBRSxrQkFBa0IsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFDSCxrQ0FBQztBQUFELENBQUMsQUFwRkQsSUFvRkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IEdvb2dsZSBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXHJcbiAqIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgYXQgaHR0cHM6Ly9hbmd1bGFyLmlvL2xpY2Vuc2VcclxuICovXHJcbmltcG9ydCB7IMm1UGFyc2VkTWVzc2FnZSB9IGZyb20gJ0Bhbmd1bGFyL2xvY2FsaXplJztcclxuaW1wb3J0IHsgUGFyc2VkTWVzc2FnZUxlZ2FjeSB9IGZyb20gJy4uLy4uLy4uL2NtZHMvY29tbW9uL3V0aWwnO1xyXG5pbXBvcnQgeyBUcmFuc2xhdGlvblNlcmlhbGl6ZXIgfSBmcm9tICcuL3RyYW5zbGF0aW9uX3NlcmlhbGl6ZXInO1xyXG5pbXBvcnQgeyBYbWxGaWxlIH0gZnJvbSAnLi94bWxfZmlsZSc7XHJcblxyXG5leHBvcnQgY2xhc3MgWGxpZmYyVHJhbnNsYXRpb25TZXJpYWxpemVyIGltcGxlbWVudHMgVHJhbnNsYXRpb25TZXJpYWxpemVyIHtcclxuICByZW5kZXJGaWxlKFxyXG4gICAgbWVzc2FnZXM6ICjJtVBhcnNlZE1lc3NhZ2UgfCBQYXJzZWRNZXNzYWdlTGVnYWN5KVtdLFxyXG4gICAgbG9jYWxlOiBzdHJpbmcsXHJcbiAgICBpc1RhcmdldCA9IGZhbHNlXHJcbiAgKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHhtbCA9IG5ldyBYbWxGaWxlKCk7XHJcbiAgICB4bWwuc3RhcnRUYWcoJ3hsaWZmJywge1xyXG4gICAgICB2ZXJzaW9uOiAnMi4wJyxcclxuICAgICAgeG1sbnM6ICd1cm46b2FzaXM6bmFtZXM6dGM6eGxpZmY6ZG9jdW1lbnQ6Mi4wJyxcclxuICAgICAgc3JjTGFuZzogbG9jYWxlLFxyXG4gICAgICB0cmdMYW5nOiBsb2NhbGVcclxuICAgIH0pO1xyXG4gICAgeG1sLnN0YXJ0VGFnKCdmaWxlJyk7XHJcbiAgICBtZXNzYWdlcy5mb3JFYWNoKG1lc3NhZ2UgPT4ge1xyXG4gICAgICB4bWwuc3RhcnRUYWcoJ3VuaXQnLCB7XHJcbiAgICAgICAgaWQ6XHJcbiAgICAgICAgICAobWVzc2FnZSBhcyDJtVBhcnNlZE1lc3NhZ2UpLmlkIHx8XHJcbiAgICAgICAgICAobWVzc2FnZSBhcyBQYXJzZWRNZXNzYWdlTGVnYWN5KS5tZXNzYWdlSWRcclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChtZXNzYWdlLm1lYW5pbmcgfHwgbWVzc2FnZS5kZXNjcmlwdGlvbikge1xyXG4gICAgICAgIHhtbC5zdGFydFRhZygnbm90ZXMnKTtcclxuICAgICAgICBpZiAobWVzc2FnZS5kZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgdGhpcy5yZW5kZXJOb3RlKHhtbCwgJ2Rlc2NyaXB0aW9uJywgbWVzc2FnZS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtZXNzYWdlLm1lYW5pbmcpIHtcclxuICAgICAgICAgIHRoaXMucmVuZGVyTm90ZSh4bWwsICdtZWFuaW5nJywgbWVzc2FnZS5tZWFuaW5nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeG1sLmVuZFRhZygnbm90ZXMnKTtcclxuICAgICAgfVxyXG4gICAgICB4bWwuc3RhcnRUYWcoJ3NlZ21lbnQnKTtcclxuICAgICAgaWYgKCFpc1RhcmdldCkge1xyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVNZXNzYWdlVGFnKHhtbCwgJ3NvdXJjZScsIG1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZ2VuZXJhdGVNZXNzYWdlVGFnKHhtbCwgJ3RhcmdldCcsIG1lc3NhZ2UpO1xyXG4gICAgICB4bWwuZW5kVGFnKCdzZWdtZW50Jyk7XHJcbiAgICAgIHhtbC5lbmRUYWcoJ3VuaXQnKTtcclxuICAgIH0pO1xyXG4gICAgeG1sLmVuZFRhZygnZmlsZScpO1xyXG4gICAgeG1sLmVuZFRhZygneGxpZmYnKTtcclxuICAgIHJldHVybiB4bWwudG9TdHJpbmcoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVNZXNzYWdlVGFnKFxyXG4gICAgeG1sOiBYbWxGaWxlLFxyXG4gICAgdGFnTmFtZTogc3RyaW5nLFxyXG4gICAgbWVzc2FnZTogybVQYXJzZWRNZXNzYWdlIHwgUGFyc2VkTWVzc2FnZUxlZ2FjeVxyXG4gICkge1xyXG4gICAgeG1sLnN0YXJ0VGFnKHRhZ05hbWUsIHt9LCB7IHByZXNlcnZlV2hpdGVzcGFjZTogdHJ1ZSB9KTtcclxuICAgIHRoaXMucmVuZGVyTWVzc2FnZSh4bWwsIG1lc3NhZ2UpO1xyXG4gICAgeG1sLmVuZFRhZyh0YWdOYW1lLCB7IHByZXNlcnZlV2hpdGVzcGFjZTogZmFsc2UgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlbmRlck1lc3NhZ2UoXHJcbiAgICB4bWw6IFhtbEZpbGUsXHJcbiAgICBtZXNzYWdlOiDJtVBhcnNlZE1lc3NhZ2UgfCBQYXJzZWRNZXNzYWdlTGVnYWN5XHJcbiAgKTogdm9pZCB7XHJcbiAgICB4bWwudGV4dChtZXNzYWdlLm1lc3NhZ2VQYXJ0c1swXSk7XHJcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IG1lc3NhZ2UubWVzc2FnZVBhcnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IHBsYWNlaG9sZGVyTmFtZSA9IG1lc3NhZ2UucGxhY2Vob2xkZXJOYW1lc1tpIC0gMV07XHJcbiAgICAgIGlmIChwbGFjZWhvbGRlck5hbWUuc3RhcnRzV2l0aCgnU1RBUlRfJykpIHtcclxuICAgICAgICB4bWwuc3RhcnRUYWcoJ3BjJywge1xyXG4gICAgICAgICAgaWQ6IGAke2l9YCxcclxuICAgICAgICAgIGVxdWl2U3RhcnQ6IHBsYWNlaG9sZGVyTmFtZSxcclxuICAgICAgICAgIGVxdWl2RW5kOiBwbGFjZWhvbGRlck5hbWUucmVwbGFjZSgvXlNUQVJULywgJ0NMT1NFJylcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmIChwbGFjZWhvbGRlck5hbWUuc3RhcnRzV2l0aCgnQ0xPU0VfJykpIHtcclxuICAgICAgICB4bWwuZW5kVGFnKCdwYycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHhtbC5zdGFydFRhZyhcclxuICAgICAgICAgICdwaCcsXHJcbiAgICAgICAgICB7IGlkOiBgJHtpfWAsIGVxdWl2OiBwbGFjZWhvbGRlck5hbWUgfSxcclxuICAgICAgICAgIHsgc2VsZkNsb3Npbmc6IHRydWUgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgICAgeG1sLnRleHQobWVzc2FnZS5tZXNzYWdlUGFydHNbaV0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZW5kZXJOb3RlKHhtbDogWG1sRmlsZSwgbmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB4bWwuc3RhcnRUYWcoJ25vdGUnLCB7IGNhdGVnb3J5OiBuYW1lIH0sIHsgcHJlc2VydmVXaGl0ZXNwYWNlOiB0cnVlIH0pO1xyXG4gICAgeG1sLnRleHQodmFsdWUpO1xyXG4gICAgeG1sLmVuZFRhZygnbm90ZScsIHsgcHJlc2VydmVXaGl0ZXNwYWNlOiBmYWxzZSB9KTtcclxuICB9XHJcbn1cclxuIl19